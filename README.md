# Human Simulation Starter

**–°—Ç–∞—Ä—Ç–µ—Ä-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è "–∞–Ω–¥—Ä–æ–∏–¥–∞–º–∏" —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–∏—ë–º–∞ –∫–æ–º–∞–Ω–¥, –∞—É–¥–∏—Ç–∞ –¥–µ–π—Å—Ç–≤–∏–π –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –≠—Ç–æ —Å—Ç–∞—Ä—Ç–µ—Ä-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –∞ –Ω–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å—Ç–∞—Ä—Ç–µ—Ä–∞

### üìã –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- **–ü—Ä–∏—ë–º –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥** —á–µ—Ä–µ–∑ REST API
- **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥** (CRITICAL - –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, COMMON - –≤ –æ—á–µ—Ä–µ–¥—å)
- **–ê—É–¥–∏—Ç –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Kafka –∏–ª–∏ –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏** –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –∫–æ–º–∞–Ω–¥** —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- **ThreadPoolExecutor** –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á
- **Spring Boot Actuator** –∏ **Micrometer** –¥–ª—è –º–µ—Ç—Ä–∏–∫
- **Kafka –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞—É–¥–∏—Ç–∞

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—Ç–µ—Ä–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Java 21+
- Gradle 8+ –∏–ª–∏ Maven
- Kafka (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∞—É–¥–∏—Ç–∞)

### 1. –°–±–æ—Ä–∫–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞
```bash
git clone <repository-url>
cd Human-simulation-starter
./gradlew clean build publishToMavenLocal
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ

#### –î–æ–±–∞–≤—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ build.gradle.kts:
```kotlin
dependencies {
    implementation("org.project:human-simulation-starter:1.0-SNAPSHOT")
}
```

#### –ò–ª–∏ –≤ pom.xml:
```xml
<dependency>
    <groupId>org.project</groupId>
    <artifactId>human-simulation-starter</artifactId>
    <version>1.0-SNAPSHOT</version>
</dependency>
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å main –∫–ª–∞—Å—Å–æ–º

–°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—Ç–µ—Ä:

```java
@SpringBootApplication
@EnableAspectJAutoProxy
public class YourApplication {
    public static void main(String[] args) {
        SpringApplication.run(YourApplication.class, args);
    }
}
```

### 4. –ó–∞–ø—É—Å–∫ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
./gradlew bootRun
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—Ç–µ—Ä–∞

### –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è –¥–ª—è –∞—É–¥–∏—Ç–∞
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é `@WeylandWatchingYou` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞—É–¥–∏—Ç–∞ –º–µ—Ç–æ–¥–æ–≤:

```java
@WeylandWatchingYou(auditMode = AuditMode.CONSOLE)
public void someMethod() {
    // –í–∞—à –∫–æ–¥
}

@WeylandWatchingYou(auditMode = AuditMode.KAFKA, kafkaTopic = "audit-topic")
public void anotherMethod() {
    // –í–∞—à –∫–æ–¥
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ REST –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
```java
@RestController
@RequestMapping("/api/commands")
public class CommandController {
    
    @Autowired
    private CommandHandlerService commandHandlerService;
    
    @PostMapping
    public ResponseEntity<String> handleCommand(@RequestBody Command command) {
        commandHandlerService.handleCommand(command);
        return ResponseEntity.ok("Command received");
    }
}
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥
```bash
# CRITICAL –∫–æ–º–∞–Ω–¥–∞ (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
curl -X POST http://localhost:8081/api/commands \
  -H "Content-Type: application/json" \
  -d '{
    "description": "Critical task",
    "priority": "CRITICAL",
    "author": "user1"
  }'

# COMMON –∫–æ–º–∞–Ω–¥–∞ (–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å)
curl -X POST http://localhost:8081/api/commands \
  -H "Content-Type: application/json" \
  -d '{
    "description": "Regular task",
    "priority": "COMMON",
    "author": "user2"
  }'
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### Actuator endpoints
- `http://localhost:8081/actuator/health` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `http://localhost:8081/actuator/metrics` - –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏
- `http://localhost:8081/actuator/prometheus` - –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus

### REST API –¥–ª—è –º–µ—Ç—Ä–∏–∫
- `http://localhost:8081/api/metrics/queue-size` - —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏
- `http://localhost:8081/api/metrics/completed-tasks` - –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
- `http://localhost:8081/api/metrics/summary` - —Å–≤–æ–¥–∫–∞ –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- `android.queue.size` - —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ –∫–æ–º–∞–Ω–¥
- `android.completed.tasks` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –ø–æ –∞–≤—Ç–æ—Ä–∞–º

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### application.properties
```properties
# Server
server.port=8081

# Actuator
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always

# Kafka (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
spring.kafka.bootstrap-servers=localhost:9092
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.apache.kafka.common.serialization.StringSerializer
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ThreadPoolExecutor
–í `CommandHandlerService` –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
- **Core Pool Size**: 2 –ø–æ—Ç–æ–∫–∞ (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
- **Maximum Pool Size**: 5 –ø–æ—Ç–æ–∫–æ–≤ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
- **Queue Size**: 100 –∑–∞–¥–∞—á (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏)
- **Keep Alive Time**: 60 —Å–µ–∫—É–Ω–¥

## üîç –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **CommandHandlerService** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ —Å ThreadPoolExecutor
- **AuditAspect** - AOP –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞—É–¥–∏—Ç–∞
- **AuditSenderKafkaService** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∞—É–¥–∏—Ç–∞ –≤ Kafka/–∫–æ–Ω—Å–æ–ª—å
- **MetricsService** - —Å–±–æ—Ä –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
- **WorkloadMonitorService** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏
- **GlobalExceptionHandler** - –≥–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π



## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### HTTP –∫–æ–¥—ã –æ—à–∏–±–æ–∫
- **400 Bad Request** - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **503 Service Unavailable** - –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏ –∫–æ–º–∞–Ω–¥
- **500 Internal Server Error** - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—à–∏–±–∫–∏

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ
```json
{
  "error": "Command queue is full",
  "timestamp": 1752992448984,
  "type": "QUEUE_OVERFLOW"
}
```


### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞—É–¥–∏—Ç–∞
```java
@WeylandWatchingYou(auditMode = AuditMode.KAFKA, kafkaTopic = "custom-topic")
public void customMethod() {
    // –í–∞—à –∫–æ–¥ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∞—É–¥–∏—Ç–æ–º
}
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã
1. **–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã** ‚Üí REST API
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞** ‚Üí ThreadPoolExecutor
3. **–ê—É–¥–∏—Ç** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ AOP
4. **–ú–µ—Ç—Ä–∏–∫–∏** ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Üí —á–µ—Ä–µ–∑ Actuator/REST API

### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—Ç–µ—Ä:

```java
@SpringBootApplication
@EnableAspectJAutoProxy
public class BishopPrototype {
    public static void main(String[] args) {
        SpringApplication.run(BishopPrototype.class, args);
    }
}

@RestController
public class CommandController {
    @Autowired
    private CommandHandlerService commandHandlerService;
    
    @PostMapping("/api/commands")
    public ResponseEntity<String> handleCommand(@RequestBody Command command) {
        commandHandlerService.handleCommand(command);
        return ResponseEntity.ok("Command processed");
    }
}
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- **Prometheus** ‚Üí `/actuator/prometheus`
- **Kafka** ‚Üí –∞—É–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π
- **Grafana** ‚Üí –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ MIT License.
